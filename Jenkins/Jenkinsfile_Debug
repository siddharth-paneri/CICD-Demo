pipeline {
    agent any
    stages {
        /*
        stage('Bundle update') {
            steps {
                sh "bundle update"
            }
        }
        */
        stage('Increment Build Number') {
            steps {
                echo "Running ${env.BUILD_ID} on ${env.JENKINS_URL} at workspace: ${env.WORKSPACE}"
                sh "fastlane ios incrementBuildNumber"
            }
        }
        stage('Build & Codesigning Debug ipa') {
            steps {
                sh "fastlane ios buildDebug"
                sh "ruby -v"
            }
        }
        /*
        stage('Invoke Job 2') {
            steps {
                build job: 'oe-plus-ios-multi-job-2', wait: 'false'
            }
        }
        */

    }
    post {
        success {
            sh "echo Job1 succeeded"
        }
        failure {
            sh "echo Job2 failed"
        }
    }
}
